####################################################

This code is based on a preliminary version of the BSM3G code initiated by:
Andres Florez (Los Andes), Alfredo Gurrola (Vanderbilt) and Amandeep Kalsi (Panjab) 
(See https://github.com/florez/NtupleMaker_740)

It has been extended and further developed by Francesco Romeo (IHEP) and Aniello Spiezia (IHEP).

This version of code is used for 2017 miniAOD v2  Ntuple production:
data: dataset=/*/Run2017*31Mar2018*/MINIAOD
MC: dataset=/*/*12Apr2018*/MINIAODSIM
####################################################


cmsrel CMSSW_9_4_9_cand2
cd CMSSW_9_4_9_cand2/src
cmsenv

## set up Egamma Tools 
## https://twiki.cern.ch/twiki/bin/view/CMS/EgammaMiniAODV2
git cms-init
git cms-merge-topic cms-egamma:EgammaID_949 #if you want the FallV2 IDs, otherwise skip
scram b -j 8

## set up MET corrections with EE nosie fix
# https://twiki.cern.ch/twiki/bin/view/CMS/MissingETUncertaintyPrescription#Instructions_for_9_4_X_X_9_for_2
# one also needs to modify the met correction in miniAOD_MC2017.py & miniAOD_RD2017.py as described above
# this comes at August and is not tested 
git cms-merge-topic cms-met:METFixEE2017_949_v2
scram b -j 8


## set BSM Framework
git clone https://github.com/TaozheYu/BSMFramework.git
cd BSMFramework/
git checkout CMSSW_9_4_6_patch1
cd ..
scram b -j 8

## To Run ##
cd BSMFramework/BSM3G_TNT_Maker/python/
cmsRun miniAOD_MC2016.py  # data: cmsRun miniAOD_RD2016.py

